
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>sympy.vector.vector &#8212; SymPy 1.3 documentation</title>
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="https://live.sympy.org/static/live-core.css" />
    <link rel="stylesheet" type="text/css" href="https://live.sympy.org/static/live-autocomplete.css" />
    <link rel="stylesheet" type="text/css" href="https://live.sympy.org/static/live-sphinx.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <script type="text/javascript" src="https://live.sympy.org/static/utilities.js"></script>
    <script type="text/javascript" src="https://live.sympy.org/static/external/classy.js"></script>
    <script type="text/javascript" src="https://live.sympy.org/static/live-core.js"></script>
    <script type="text/javascript" src="https://live.sympy.org/static/live-autocomplete.js"></script>
    <script type="text/javascript" src="https://live.sympy.org/static/live-sphinx.js"></script>
    
    <link rel="shortcut icon" href="../../../_static/sympy-notailtext-favicon.ico"/>
    <link href="http://docs.sympy.org/latest/_modules/sympy/vector/vector.html" rel="canonical" />
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">SymPy 1.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sympy.vector.vector</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sympy.core.assumptions</span> <span class="k">import</span> <span class="n">StdFactKB</span>
<span class="kn">from</span> <span class="nn">sympy.core</span> <span class="k">import</span> <span class="n">S</span><span class="p">,</span> <span class="n">Pow</span><span class="p">,</span> <span class="n">sympify</span>
<span class="kn">from</span> <span class="nn">sympy.core.expr</span> <span class="k">import</span> <span class="n">AtomicExpr</span><span class="p">,</span> <span class="n">Expr</span>
<span class="kn">from</span> <span class="nn">sympy.core.compatibility</span> <span class="k">import</span> <span class="nb">range</span><span class="p">,</span> <span class="n">default_sort_key</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">ImmutableMatrix</span> <span class="k">as</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">Add</span>
<span class="kn">from</span> <span class="nn">sympy.vector.coordsysrect</span> <span class="k">import</span> <span class="n">CoordSys3D</span>
<span class="kn">from</span> <span class="nn">sympy.vector.basisdependent</span> <span class="k">import</span> <span class="p">(</span><span class="n">BasisDependent</span><span class="p">,</span> <span class="n">BasisDependentAdd</span><span class="p">,</span>
                                         <span class="n">BasisDependentMul</span><span class="p">,</span> <span class="n">BasisDependentZero</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sympy.vector.dyadic</span> <span class="k">import</span> <span class="n">BaseDyadic</span><span class="p">,</span> <span class="n">Dyadic</span><span class="p">,</span> <span class="n">DyadicAdd</span>


<div class="viewcode-block" id="Vector"><a class="viewcode-back" href="../../../modules/vector/api/classes.html#sympy.vector.vector.Vector">[docs]</a><span class="k">class</span> <span class="nc">Vector</span><span class="p">(</span><span class="n">BasisDependent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Super class for all Vector classes.</span>
<span class="sd">    Ideally, neither this class nor any of its subclasses should be</span>
<span class="sd">    instantiated by the user.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">is_Vector</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">_op_priority</span> <span class="o">=</span> <span class="mf">12.0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">components</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the components of this vector in the form of a</span>
<span class="sd">        Python dictionary mapping BaseVector instances to the</span>
<span class="sd">        corresponding measure numbers.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.vector import CoordSys3D</span>
<span class="sd">        &gt;&gt;&gt; C = CoordSys3D(&#39;C&#39;)</span>
<span class="sd">        &gt;&gt;&gt; v = 3*C.i + 4*C.j + 5*C.k</span>
<span class="sd">        &gt;&gt;&gt; v.components</span>
<span class="sd">        {C.i: 3, C.j: 4, C.k: 5}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The &#39;_components&#39; attribute is defined according to the</span>
        <span class="c1"># subclass of Vector the instance belongs to.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span>

<div class="viewcode-block" id="Vector.magnitude"><a class="viewcode-back" href="../../../modules/vector/api/classes.html#sympy.vector.vector.Vector.magnitude">[docs]</a>    <span class="k">def</span> <span class="nf">magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the magnitude of this vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Vector.normalize"><a class="viewcode-back" href="../../../modules/vector/api/classes.html#sympy.vector.vector.Vector.normalize">[docs]</a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the normalized version of this vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">magnitude</span><span class="p">()</span></div>

<div class="viewcode-block" id="Vector.dot"><a class="viewcode-back" href="../../../modules/vector/api/classes.html#sympy.vector.vector.Vector.dot">[docs]</a>    <span class="k">def</span> <span class="nf">dot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the dot product of this Vector, either with another</span>
<span class="sd">        Vector, or a Dyadic, or a Del operator.</span>
<span class="sd">        If &#39;other&#39; is a Vector, returns the dot product scalar (Sympy</span>
<span class="sd">        expression).</span>
<span class="sd">        If &#39;other&#39; is a Dyadic, the dot product is returned as a Vector.</span>
<span class="sd">        If &#39;other&#39; is an instance of Del, returns the directional</span>
<span class="sd">        derivative operator as a Python function. If this function is</span>
<span class="sd">        applied to a scalar expression, it returns the directional</span>
<span class="sd">        derivative of the scalar field wrt this Vector.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>

<span class="sd">        other: Vector/Dyadic/Del</span>
<span class="sd">            The Vector or Dyadic we are dotting with, or a Del operator .</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.vector import CoordSys3D, Del</span>
<span class="sd">        &gt;&gt;&gt; C = CoordSys3D(&#39;C&#39;)</span>
<span class="sd">        &gt;&gt;&gt; delop = Del()</span>
<span class="sd">        &gt;&gt;&gt; C.i.dot(C.j)</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; C.i &amp; C.i</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; v = 3*C.i + 4*C.j + 5*C.k</span>
<span class="sd">        &gt;&gt;&gt; v.dot(C.k)</span>
<span class="sd">        5</span>
<span class="sd">        &gt;&gt;&gt; (C.i &amp; delop)(C.x*C.y*C.z)</span>
<span class="sd">        C.y*C.z</span>
<span class="sd">        &gt;&gt;&gt; d = C.i.outer(C.i)</span>
<span class="sd">        &gt;&gt;&gt; C.i.dot(d)</span>
<span class="sd">        C.i</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check special cases</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Dyadic</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">VectorZero</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Vector</span><span class="o">.</span><span class="n">zero</span>
            <span class="n">outvec</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">zero</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">vect_dot</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">outvec</span> <span class="o">+=</span> <span class="n">vect_dot</span> <span class="o">*</span> <span class="n">v</span> <span class="o">*</span> <span class="n">k</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">outvec</span>
        <span class="kn">from</span> <span class="nn">sympy.vector.deloperator</span> <span class="k">import</span> <span class="n">Del</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Vector</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Del</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; is not a vector, dyadic or &quot;</span> <span class="o">+</span>
                            <span class="s2">&quot;del operator&quot;</span><span class="p">)</span>

        <span class="c1"># Check if the other is a del operator</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Del</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">directional_derivative</span><span class="p">(</span><span class="n">field</span><span class="p">):</span>
                <span class="kn">from</span> <span class="nn">sympy.vector.functions</span> <span class="k">import</span> <span class="n">directional_derivative</span>
                <span class="k">return</span> <span class="n">directional_derivative</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">directional_derivative</span>

        <span class="k">return</span> <span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="fm">__and__</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">dot</span><span class="o">.</span><span class="vm">__doc__</span>

<div class="viewcode-block" id="Vector.cross"><a class="viewcode-back" href="../../../modules/vector/api/classes.html#sympy.vector.vector.Vector.cross">[docs]</a>    <span class="k">def</span> <span class="nf">cross</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the cross product of this Vector with another Vector or</span>
<span class="sd">        Dyadic instance.</span>
<span class="sd">        The cross product is a Vector, if &#39;other&#39; is a Vector. If &#39;other&#39;</span>
<span class="sd">        is a Dyadic, this returns a Dyadic instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>

<span class="sd">        other: Vector/Dyadic</span>
<span class="sd">            The Vector or Dyadic we are crossing with.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.vector import CoordSys3D</span>
<span class="sd">        &gt;&gt;&gt; C = CoordSys3D(&#39;C&#39;)</span>
<span class="sd">        &gt;&gt;&gt; C.i.cross(C.j)</span>
<span class="sd">        C.k</span>
<span class="sd">        &gt;&gt;&gt; C.i ^ C.i</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; v = 3*C.i + 4*C.j + 5*C.k</span>
<span class="sd">        &gt;&gt;&gt; v ^ C.i</span>
<span class="sd">        5*C.j + (-4)*C.k</span>
<span class="sd">        &gt;&gt;&gt; d = C.i.outer(C.i)</span>
<span class="sd">        &gt;&gt;&gt; C.j.cross(d)</span>
<span class="sd">        (-1)*(C.k|C.i)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check special cases</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Dyadic</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">VectorZero</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Dyadic</span><span class="o">.</span><span class="n">zero</span>
            <span class="n">outdyad</span> <span class="o">=</span> <span class="n">Dyadic</span><span class="o">.</span><span class="n">zero</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">cross_product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">outer</span> <span class="o">=</span> <span class="n">cross_product</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">outdyad</span> <span class="o">+=</span> <span class="n">v</span> <span class="o">*</span> <span class="n">outer</span>
            <span class="k">return</span> <span class="n">outdyad</span>

        <span class="k">return</span> <span class="n">cross</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="fm">__xor__</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">cross</span><span class="o">.</span><span class="vm">__doc__</span>

<div class="viewcode-block" id="Vector.outer"><a class="viewcode-back" href="../../../modules/vector/api/classes.html#sympy.vector.vector.Vector.outer">[docs]</a>    <span class="k">def</span> <span class="nf">outer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the outer product of this vector with another, in the</span>
<span class="sd">        form of a Dyadic instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>

<span class="sd">        other : Vector</span>
<span class="sd">            The Vector with respect to which the outer product is to</span>
<span class="sd">            be computed.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.vector import CoordSys3D</span>
<span class="sd">        &gt;&gt;&gt; N = CoordSys3D(&#39;N&#39;)</span>
<span class="sd">        &gt;&gt;&gt; N.i.outer(N.j)</span>
<span class="sd">        (N.i|N.j)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Handle the special cases</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Vector</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid operand for outer product&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">VectorZero</span><span class="p">)</span> <span class="ow">or</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">VectorZero</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">Dyadic</span><span class="o">.</span><span class="n">zero</span>

        <span class="c1"># Iterate over components of both the vectors to generate</span>
        <span class="c1"># the required Dyadic instance</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k1</span><span class="p">,</span> <span class="n">v1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">k2</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v1</span> <span class="o">*</span> <span class="n">v2</span><span class="p">)</span> <span class="o">*</span> <span class="n">BaseDyadic</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">DyadicAdd</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="Vector.projection"><a class="viewcode-back" href="../../../modules/vector/api/classes.html#sympy.vector.vector.Vector.projection">[docs]</a>    <span class="k">def</span> <span class="nf">projection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the vector or scalar projection of the &#39;other&#39; on &#39;self&#39;.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.vector.coordsysrect import CoordSys3D</span>
<span class="sd">        &gt;&gt;&gt; from sympy.vector.vector import Vector, BaseVector</span>
<span class="sd">        &gt;&gt;&gt; C = CoordSys3D(&#39;C&#39;)</span>
<span class="sd">        &gt;&gt;&gt; i, j, k = C.base_vectors()</span>
<span class="sd">        &gt;&gt;&gt; v1 = i + j + k</span>
<span class="sd">        &gt;&gt;&gt; v2 = 3*i + 4*j</span>
<span class="sd">        &gt;&gt;&gt; v1.projection(v2)</span>
<span class="sd">        7/3*C.i + 7/3*C.j + 7/3*C.k</span>
<span class="sd">        &gt;&gt;&gt; v1.projection(v2, scalar=True)</span>
<span class="sd">        7/3</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">Vector</span><span class="o">.</span><span class="n">zero</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">zero</span> <span class="k">if</span> <span class="n">scalar</span> <span class="k">else</span> <span class="n">Vector</span><span class="o">.</span><span class="n">zero</span>

        <span class="k">if</span> <span class="n">scalar</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_projections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the components of this vector but the output includes</span>
<span class="sd">        also zero values components.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.vector import CoordSys3D, Vector</span>
<span class="sd">        &gt;&gt;&gt; C = CoordSys3D(&#39;C&#39;)</span>
<span class="sd">        &gt;&gt;&gt; v1 = 3*C.i + 4*C.j + 5*C.k</span>
<span class="sd">        &gt;&gt;&gt; v1._projections</span>
<span class="sd">        (3, 4, 5)</span>
<span class="sd">        &gt;&gt;&gt; v2 = C.x*C.y*C.z*C.i</span>
<span class="sd">        &gt;&gt;&gt; v2._projections</span>
<span class="sd">        (C.x*C.y*C.z, 0, 0)</span>
<span class="sd">        &gt;&gt;&gt; v3 = Vector.zero</span>
<span class="sd">        &gt;&gt;&gt; v3._projections</span>
<span class="sd">        (0, 0, 0)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">sympy.vector.operators</span> <span class="k">import</span> <span class="n">_get_coord_sys_from_expr</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">VectorZero</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">S</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">S</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">base_vec</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">_get_coord_sys_from_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span><span class="o">.</span><span class="n">base_vectors</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">base_vec</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="fm">__or__</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">outer</span><span class="o">.</span><span class="vm">__doc__</span>

<div class="viewcode-block" id="Vector.to_matrix"><a class="viewcode-back" href="../../../modules/vector/api/classes.html#sympy.vector.vector.Vector.to_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">to_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the matrix form of this vector with respect to the</span>
<span class="sd">        specified coordinate system.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>

<span class="sd">        system : CoordSys3D</span>
<span class="sd">            The system wrt which the matrix form is to be computed</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.vector import CoordSys3D</span>
<span class="sd">        &gt;&gt;&gt; C = CoordSys3D(&#39;C&#39;)</span>
<span class="sd">        &gt;&gt;&gt; from sympy.abc import a, b, c</span>
<span class="sd">        &gt;&gt;&gt; v = a*C.i + b*C.j + c*C.k</span>
<span class="sd">        &gt;&gt;&gt; v.to_matrix(C)</span>
<span class="sd">        Matrix([</span>
<span class="sd">        [a],</span>
<span class="sd">        [b],</span>
<span class="sd">        [c]])</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">Matrix</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">unit_vec</span><span class="p">)</span> <span class="k">for</span> <span class="n">unit_vec</span> <span class="ow">in</span>
                       <span class="n">system</span><span class="o">.</span><span class="n">base_vectors</span><span class="p">()])</span></div>

<div class="viewcode-block" id="Vector.separate"><a class="viewcode-back" href="../../../modules/vector/api/classes.html#sympy.vector.vector.Vector.separate">[docs]</a>    <span class="k">def</span> <span class="nf">separate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The constituents of this vector in different coordinate systems,</span>
<span class="sd">        as per its definition.</span>

<span class="sd">        Returns a dict mapping each CoordSys3D to the corresponding</span>
<span class="sd">        constituent Vector.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from sympy.vector import CoordSys3D</span>
<span class="sd">        &gt;&gt;&gt; R1 = CoordSys3D(&#39;R1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; R2 = CoordSys3D(&#39;R2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; v = R1.i + R2.i</span>
<span class="sd">        &gt;&gt;&gt; v.separate() == {R1: R1.i, R2: R2.i}</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">parts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">vect</span><span class="p">,</span> <span class="n">measure</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">parts</span><span class="p">[</span><span class="n">vect</span><span class="o">.</span><span class="n">system</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">parts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">vect</span><span class="o">.</span><span class="n">system</span><span class="p">,</span> <span class="n">Vector</span><span class="o">.</span><span class="n">zero</span><span class="p">)</span> <span class="o">+</span>
                                  <span class="n">vect</span> <span class="o">*</span> <span class="n">measure</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">parts</span></div></div>


<span class="k">class</span> <span class="nc">BaseVector</span><span class="p">(</span><span class="n">Vector</span><span class="p">,</span> <span class="n">AtomicExpr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to denote a base vector.</span>

<span class="sd">    Unicode pretty forms in Python 2 should use the prefix ``u``.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">pretty_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latex_str</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pretty_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pretty_str</span> <span class="o">=</span> <span class="s2">&quot;x</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">latex_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">latex_str</span> <span class="o">=</span> <span class="s2">&quot;x_</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">pretty_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pretty_str</span><span class="p">)</span>
        <span class="n">latex_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">latex_str</span><span class="p">)</span>
        <span class="c1"># Verify arguments</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;index must be 0, 1 or 2&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">CoordSys3D</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;system should be a CoordSys3D&quot;</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">_vector_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="c1"># Initialize an object</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">BaseVector</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="n">index</span><span class="p">),</span> <span class="n">system</span><span class="p">)</span>
        <span class="c1"># Assign important attributes</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_base_instance</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_components</span> <span class="o">=</span> <span class="p">{</span><span class="n">obj</span><span class="p">:</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)}</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_measure_number</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">_name</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">name</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_pretty_form</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span> <span class="o">+</span> <span class="n">pretty_str</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_latex_form</span> <span class="o">=</span> <span class="n">latex_str</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_system</span> <span class="o">=</span> <span class="n">system</span>

        <span class="n">assumptions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;commutative&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_assumptions</span> <span class="o">=</span> <span class="n">StdFactKB</span><span class="p">(</span><span class="n">assumptions</span><span class="p">)</span>

        <span class="c1"># This attr is used for re-expression to one of the systems</span>
        <span class="c1"># involved in the definition of the Vector. Applies to</span>
        <span class="c1"># VectorMul and VectorAdd too.</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_sys</span> <span class="o">=</span> <span class="n">system</span>

        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">system</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_system</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">free_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="bp">self</span><span class="p">}</span>

    <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span>
    <span class="n">_sympystr</span> <span class="o">=</span> <span class="fm">__str__</span>


<span class="k">class</span> <span class="nc">VectorAdd</span><span class="p">(</span><span class="n">BasisDependentAdd</span><span class="p">,</span> <span class="n">Vector</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to denote sum of Vector instances.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">BasisDependentAdd</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">ret_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separate</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="n">items</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="fm">__str__</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">system</span><span class="p">,</span> <span class="n">vect</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">base_vects</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">base_vectors</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">base_vects</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vect</span><span class="o">.</span><span class="n">components</span><span class="p">:</span>
                    <span class="n">temp_vect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span>
                    <span class="n">ret_str</span> <span class="o">+=</span> <span class="n">temp_vect</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="n">printer</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; + &quot;</span>
        <span class="k">return</span> <span class="n">ret_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>

    <span class="fm">__repr__</span> <span class="o">=</span> <span class="fm">__str__</span>
    <span class="n">_sympystr</span> <span class="o">=</span> <span class="fm">__str__</span>


<span class="k">class</span> <span class="nc">VectorMul</span><span class="p">(</span><span class="n">BasisDependentMul</span><span class="p">,</span> <span class="n">Vector</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to denote products of scalars and BaseVectors.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">BasisDependentMul</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">base_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The BaseVector involved in the product. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_instance</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">measure_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The scalar expression involved in the definition of</span>
<span class="sd">        this VectorMul.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_measure_number</span>


<span class="k">class</span> <span class="nc">VectorZero</span><span class="p">(</span><span class="n">BasisDependentZero</span><span class="p">,</span> <span class="n">Vector</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to denote a zero vector</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_op_priority</span> <span class="o">=</span> <span class="mf">12.1</span>
    <span class="n">_pretty_form</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;0&#39;</span>
    <span class="n">_latex_form</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\mathbf{\hat</span><span class="si">{0}</span><span class="s1">}&#39;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">BasisDependentZero</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>


<span class="k">class</span> <span class="nc">Cross</span><span class="p">(</span><span class="n">Vector</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents unevaluated Cross product.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.vector import CoordSys3D, Cross</span>
<span class="sd">    &gt;&gt;&gt; R = CoordSys3D(&#39;R&#39;)</span>
<span class="sd">    &gt;&gt;&gt; v1 = R.i + R.j + R.k</span>
<span class="sd">    &gt;&gt;&gt; v2 = R.x * R.i + R.y * R.j + R.z * R.k</span>
<span class="sd">    &gt;&gt;&gt; Cross(v1, v2)</span>
<span class="sd">    Cross(R.i + R.j + R.k, R.x*R.i + R.y*R.j + R.z*R.k)</span>
<span class="sd">    &gt;&gt;&gt; Cross(v1, v2).doit()</span>
<span class="sd">    (-R.y + R.z)*R.i + (R.x - R.z)*R.j + (-R.x + R.y)*R.k</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">expr1</span><span class="p">,</span> <span class="n">expr2</span><span class="p">):</span>
        <span class="n">expr1</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">expr1</span><span class="p">)</span>
        <span class="n">expr2</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">expr2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">default_sort_key</span><span class="p">(</span><span class="n">expr1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">default_sort_key</span><span class="p">(</span><span class="n">expr2</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">Cross</span><span class="p">(</span><span class="n">expr2</span><span class="p">,</span> <span class="n">expr1</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">Expr</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">expr1</span><span class="p">,</span> <span class="n">expr2</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_expr1</span> <span class="o">=</span> <span class="n">expr1</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_expr2</span> <span class="o">=</span> <span class="n">expr2</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">doit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cross</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expr1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr2</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Dot</span><span class="p">(</span><span class="n">Expr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents unevaluated Dot product.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.vector import CoordSys3D, Dot</span>
<span class="sd">    &gt;&gt;&gt; from sympy import symbols</span>
<span class="sd">    &gt;&gt;&gt; R = CoordSys3D(&#39;R&#39;)</span>
<span class="sd">    &gt;&gt;&gt; a, b, c = symbols(&#39;a b c&#39;)</span>
<span class="sd">    &gt;&gt;&gt; v1 = R.i + R.j + R.k</span>
<span class="sd">    &gt;&gt;&gt; v2 = a * R.i + b * R.j + c * R.k</span>
<span class="sd">    &gt;&gt;&gt; Dot(v1, v2)</span>
<span class="sd">    Dot(R.i + R.j + R.k, a*R.i + b*R.j + c*R.k)</span>
<span class="sd">    &gt;&gt;&gt; Dot(v1, v2).doit()</span>
<span class="sd">    a + b + c</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">expr1</span><span class="p">,</span> <span class="n">expr2</span><span class="p">):</span>
        <span class="n">expr1</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">expr1</span><span class="p">)</span>
        <span class="n">expr2</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">expr2</span><span class="p">)</span>
        <span class="n">expr1</span><span class="p">,</span> <span class="n">expr2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">expr1</span><span class="p">,</span> <span class="n">expr2</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="n">default_sort_key</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">Expr</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">expr1</span><span class="p">,</span> <span class="n">expr2</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_expr1</span> <span class="o">=</span> <span class="n">expr1</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_expr2</span> <span class="o">=</span> <span class="n">expr2</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">doit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expr1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expr2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">cross</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">vect2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns cross product of two vectors.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.vector import CoordSys3D</span>
<span class="sd">    &gt;&gt;&gt; from sympy.vector.vector import cross</span>
<span class="sd">    &gt;&gt;&gt; R = CoordSys3D(&#39;R&#39;)</span>
<span class="sd">    &gt;&gt;&gt; v1 = R.i + R.j + R.k</span>
<span class="sd">    &gt;&gt;&gt; v2 = R.x * R.i + R.y * R.j + R.z * R.k</span>
<span class="sd">    &gt;&gt;&gt; cross(v1, v2)</span>
<span class="sd">    (-R.y + R.z)*R.i + (R.x - R.z)*R.j + (-R.x + R.y)*R.k</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">Add</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">VectorAdd</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">cross</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">vect2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vect1</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect2</span><span class="p">,</span> <span class="n">Add</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">VectorAdd</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">cross</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vect2</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">BaseVector</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect2</span><span class="p">,</span> <span class="n">BaseVector</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">vect1</span><span class="o">.</span><span class="n">_sys</span> <span class="o">==</span> <span class="n">vect2</span><span class="o">.</span><span class="n">_sys</span><span class="p">:</span>
            <span class="n">n1</span> <span class="o">=</span> <span class="n">vect1</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="n">vect2</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">n1</span> <span class="o">==</span> <span class="n">n2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Vector</span><span class="o">.</span><span class="n">zero</span>
            <span class="n">n3</span> <span class="o">=</span> <span class="p">({</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">difference</span><span class="p">({</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">}))</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">n1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="n">n2</span><span class="p">)</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">return</span> <span class="n">sign</span><span class="o">*</span><span class="n">vect1</span><span class="o">.</span><span class="n">_sys</span><span class="o">.</span><span class="n">base_vectors</span><span class="p">()[</span><span class="n">n3</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.functions</span> <span class="k">import</span> <span class="n">express</span>
            <span class="k">return</span> <span class="n">cross</span><span class="p">(</span><span class="n">express</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">vect2</span><span class="o">.</span><span class="n">_sys</span><span class="p">),</span> <span class="n">vect2</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Cross</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">vect2</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">VectorZero</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect2</span><span class="p">,</span> <span class="n">VectorZero</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Vector</span><span class="o">.</span><span class="n">zero</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">VectorMul</span><span class="p">):</span>
        <span class="n">v1</span><span class="p">,</span> <span class="n">m1</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">vect1</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">m1</span><span class="o">*</span><span class="n">cross</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">vect2</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect2</span><span class="p">,</span> <span class="n">VectorMul</span><span class="p">):</span>
        <span class="n">v2</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">vect2</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">m2</span><span class="o">*</span><span class="n">cross</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Cross</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">vect2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">dot</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">vect2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns dot product of two vectors.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy.vector import CoordSys3D</span>
<span class="sd">    &gt;&gt;&gt; from sympy.vector.vector import dot</span>
<span class="sd">    &gt;&gt;&gt; R = CoordSys3D(&#39;R&#39;)</span>
<span class="sd">    &gt;&gt;&gt; v1 = R.i + R.j + R.k</span>
<span class="sd">    &gt;&gt;&gt; v2 = R.x * R.i + R.y * R.j + R.z * R.k</span>
<span class="sd">    &gt;&gt;&gt; dot(v1, v2)</span>
<span class="sd">    R.x + R.y + R.z</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">Add</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Add</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">vect2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vect1</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect2</span><span class="p">,</span> <span class="n">Add</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Add</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vect2</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">BaseVector</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect2</span><span class="p">,</span> <span class="n">BaseVector</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">vect1</span><span class="o">.</span><span class="n">_sys</span> <span class="o">==</span> <span class="n">vect2</span><span class="o">.</span><span class="n">_sys</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="k">if</span> <span class="n">vect1</span> <span class="o">==</span> <span class="n">vect2</span> <span class="k">else</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.functions</span> <span class="k">import</span> <span class="n">express</span>
            <span class="k">return</span> <span class="n">dot</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">express</span><span class="p">(</span><span class="n">vect2</span><span class="p">,</span> <span class="n">vect1</span><span class="o">.</span><span class="n">_sys</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Dot</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">vect2</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">VectorZero</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect2</span><span class="p">,</span> <span class="n">VectorZero</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">VectorMul</span><span class="p">):</span>
        <span class="n">v1</span><span class="p">,</span> <span class="n">m1</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">vect1</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">m1</span><span class="o">*</span><span class="n">dot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">vect2</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vect2</span><span class="p">,</span> <span class="n">VectorMul</span><span class="p">):</span>
        <span class="n">v2</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">vect2</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">m2</span><span class="o">*</span><span class="n">dot</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Dot</span><span class="p">(</span><span class="n">vect1</span><span class="p">,</span> <span class="n">vect2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_vect_div</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Helper for division involving vectors. &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">Vector</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Vector</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot divide two vectors&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">Vector</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">other</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot divide a vector by zero&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">VectorMul</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">Pow</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeOne</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid division involving a vector&quot;</span><span class="p">)</span>


<span class="n">Vector</span><span class="o">.</span><span class="n">_expr_type</span> <span class="o">=</span> <span class="n">Vector</span>
<span class="n">Vector</span><span class="o">.</span><span class="n">_mul_func</span> <span class="o">=</span> <span class="n">VectorMul</span>
<span class="n">Vector</span><span class="o">.</span><span class="n">_add_func</span> <span class="o">=</span> <span class="n">VectorAdd</span>
<span class="n">Vector</span><span class="o">.</span><span class="n">_zero_func</span> <span class="o">=</span> <span class="n">VectorZero</span>
<span class="n">Vector</span><span class="o">.</span><span class="n">_base_func</span> <span class="o">=</span> <span class="n">BaseVector</span>
<span class="n">Vector</span><span class="o">.</span><span class="n">_div_helper</span> <span class="o">=</span> <span class="n">_vect_div</span>
<span class="n">Vector</span><span class="o">.</span><span class="n">zero</span> <span class="o">=</span> <span class="n">VectorZero</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/sympylogo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">SymPy 1.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018 SymPy Development Team.
      Last updated on Sep 14, 2018.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.0.
    </div>
  </body>
</html>