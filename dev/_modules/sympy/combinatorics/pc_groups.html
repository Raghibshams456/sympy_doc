
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>sympy.combinatorics.pc_groups &#8212; SymPy 1.5.dev documentation</title>
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="https://live.sympy.org/static/live-core.css" />
    <link rel="stylesheet" type="text/css" href="https://live.sympy.org/static/live-autocomplete.css" />
    <link rel="stylesheet" type="text/css" href="https://live.sympy.org/static/live-sphinx.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script type="text/javascript" src="https://live.sympy.org/static/utilities.js"></script>
    <script type="text/javascript" src="https://live.sympy.org/static/external/classy.js"></script>
    <script type="text/javascript" src="https://live.sympy.org/static/live-core.js"></script>
    <script type="text/javascript" src="https://live.sympy.org/static/live-autocomplete.js"></script>
    <script type="text/javascript" src="https://live.sympy.org/static/live-sphinx.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML-full"></script>
    
    <link rel="shortcut icon" href="../../../_static/sympy-notailtext-favicon.ico"/>
    <link href="https://docs.sympy.org/latest/_modules/sympy/combinatorics/pc_groups.html" rel="canonical" />
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">SymPy 1.5.dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for sympy.combinatorics.pc_groups</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sympy.core</span> <span class="k">import</span> <span class="n">Basic</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">isprime</span><span class="p">,</span> <span class="n">symbols</span>
<span class="kn">from</span> <span class="nn">sympy.combinatorics.perm_groups</span> <span class="k">import</span> <span class="n">PermutationGroup</span>
<span class="kn">from</span> <span class="nn">sympy.printing.defaults</span> <span class="k">import</span> <span class="n">DefaultPrinting</span>
<span class="kn">from</span> <span class="nn">sympy.combinatorics.free_groups</span> <span class="k">import</span> <span class="n">free_group</span>

<div class="viewcode-block" id="PolycyclicGroup"><a class="viewcode-back" href="../../../modules/combinatorics/pc_groups.html#sympy.combinatorics.pc_groups.PolycyclicGroup">[docs]</a><span class="k">class</span> <span class="nc">PolycyclicGroup</span><span class="p">(</span><span class="n">DefaultPrinting</span><span class="p">):</span>

    <span class="n">is_group</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">is_solvable</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pc_sequence</span><span class="p">,</span> <span class="n">pc_series</span><span class="p">,</span> <span class="n">relative_order</span><span class="p">,</span> <span class="n">collector</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pcgs</span> <span class="o">=</span> <span class="n">pc_sequence</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pc_series</span> <span class="o">=</span> <span class="n">pc_series</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relative_order</span> <span class="o">=</span> <span class="n">relative_order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collector</span> <span class="o">=</span> <span class="n">Collector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pcgs</span><span class="p">,</span> <span class="n">pc_series</span><span class="p">,</span> <span class="n">relative_order</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">collector</span> <span class="k">else</span> <span class="n">collector</span>

    <span class="k">def</span> <span class="nf">is_prime_order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">isprime</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relative_order</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pcgs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Collector"><a class="viewcode-back" href="../../../modules/combinatorics/pc_groups.html#sympy.combinatorics.pc_groups.Collector">[docs]</a><span class="k">class</span> <span class="nc">Collector</span><span class="p">(</span><span class="n">DefaultPrinting</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] Holt, D., Eick, B., O&#39;Brien, E.</span>
<span class="sd">           &quot;Handbook of Computational Group Theory&quot;</span>
<span class="sd">           Section 8.1.3</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pcgs</span><span class="p">,</span> <span class="n">pc_series</span><span class="p">,</span> <span class="n">relative_order</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pc_presentation</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pcgs</span> <span class="o">=</span> <span class="n">pcgs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pc_series</span> <span class="o">=</span> <span class="n">pc_series</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relative_order</span> <span class="o">=</span> <span class="n">relative_order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">free_group</span> <span class="o">=</span> <span class="n">free_group</span><span class="p">(</span><span class="s1">&#39;x:</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pcgs</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">group</span> <span class="k">else</span> <span class="n">group</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">free_group</span><span class="o">.</span><span class="n">symbols</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pc_presentation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pc_relators</span><span class="p">()</span>

<div class="viewcode-block" id="Collector.minimal_uncollected_subword"><a class="viewcode-back" href="../../../modules/combinatorics/pc_groups.html#sympy.combinatorics.pc_groups.Collector.minimal_uncollected_subword">[docs]</a>    <span class="k">def</span> <span class="nf">minimal_uncollected_subword</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the minimal uncollected subwords.</span>

<span class="sd">        A word `v` defined on generators in `X` is a minimal</span>
<span class="sd">        uncollected subword of the word `w` if `v` is a subword</span>
<span class="sd">        of `w` and it has one of the following form</span>

<span class="sd">        i) `v = x[i+1]**a_j*x[i]`</span>

<span class="sd">        ii) `v = x[i+1]**a_j*x[i]**-1`</span>

<span class="sd">        iii) `v = x[i]**a_j` for relative_order of `x[i] != infinity`</span>
<span class="sd">        and `a_j` is not in `{1, ..., s-1}`. Where, s is the power</span>
<span class="sd">        exponent of the corresponding generator.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.named_groups import SymmetricGroup</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.free_groups import free_group</span>
<span class="sd">        &gt;&gt;&gt; G = SymmetricGroup(4)</span>
<span class="sd">        &gt;&gt;&gt; PcGroup = G.polycyclic_group()</span>
<span class="sd">        &gt;&gt;&gt; collector = PcGroup.collector</span>
<span class="sd">        &gt;&gt;&gt; F, x1, x2 = free_group(&quot;x1, x2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; word = x2**2*x1**7</span>
<span class="sd">        &gt;&gt;&gt; collector.minimal_uncollected_subword(word)</span>
<span class="sd">        ((x2, 2),)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># To handle the case word = &lt;identity&gt;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">word</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">array</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">re</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relative_order</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)):</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">e1</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">re</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="n">s1</span><span class="p">]]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">e1</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">e1</span> <span class="o">&gt;</span> <span class="n">re</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="n">s1</span><span class="p">]]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">((</span><span class="n">s1</span><span class="p">,</span> <span class="n">e1</span><span class="p">),</span> <span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">e1</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">s2</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">index</span><span class="p">[</span><span class="n">s1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">index</span><span class="p">[</span><span class="n">s2</span><span class="p">]:</span>
                <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">e2</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">return</span> <span class="p">((</span><span class="n">s1</span><span class="p">,</span> <span class="n">e1</span><span class="p">),</span> <span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Collector.relations"><a class="viewcode-back" href="../../../modules/combinatorics/pc_groups.html#sympy.combinatorics.pc_groups.Collector.relations">[docs]</a>    <span class="k">def</span> <span class="nf">relations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Separates the given relators of pc presentation in power and</span>
<span class="sd">        conjugate relations.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.named_groups import SymmetricGroup</span>
<span class="sd">        &gt;&gt;&gt; G = SymmetricGroup(3)</span>
<span class="sd">        &gt;&gt;&gt; PcGroup = G.polycyclic_group()</span>
<span class="sd">        &gt;&gt;&gt; collector = PcGroup.collector</span>
<span class="sd">        &gt;&gt;&gt; power_rel, conj_rel = collector.relations()</span>
<span class="sd">        &gt;&gt;&gt; power_rel</span>
<span class="sd">        {x0**2: (), x1**3: ()}</span>
<span class="sd">        &gt;&gt;&gt; conj_rel</span>
<span class="sd">        {x0**-1*x1*x0: x1**2}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">power_relators</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">conjugate_relators</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pc_presentation</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">array_form</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">power_relators</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">conjugate_relators</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">power_relators</span><span class="p">,</span> <span class="n">conjugate_relators</span></div>

<div class="viewcode-block" id="Collector.subword_index"><a class="viewcode-back" href="../../../modules/combinatorics/pc_groups.html#sympy.combinatorics.pc_groups.Collector.subword_index">[docs]</a>    <span class="k">def</span> <span class="nf">subword_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the start and ending index of a given</span>
<span class="sd">        subword in a word.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.named_groups import SymmetricGroup</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.free_groups import free_group</span>
<span class="sd">        &gt;&gt;&gt; G = SymmetricGroup(4)</span>
<span class="sd">        &gt;&gt;&gt; PcGroup = G.polycyclic_group()</span>
<span class="sd">        &gt;&gt;&gt; collector = PcGroup.collector</span>
<span class="sd">        &gt;&gt;&gt; F, x1, x2 = free_group(&quot;x1, x2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; word = x2**2*x1**7</span>
<span class="sd">        &gt;&gt;&gt; w = x2**2*x1</span>
<span class="sd">        &gt;&gt;&gt; collector.subword_index(word, w)</span>
<span class="sd">        (0, 3)</span>
<span class="sd">        &gt;&gt;&gt; w = x1**7</span>
<span class="sd">        &gt;&gt;&gt; collector.subword_index(word, w)</span>
<span class="sd">        (2, 9)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">low</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">high</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">subword</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">))</span> <span class="o">==</span> <span class="n">w</span><span class="p">:</span>
                <span class="n">low</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">high</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">low</span> <span class="o">==</span> <span class="n">high</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span></div>

<div class="viewcode-block" id="Collector.map_relation"><a class="viewcode-back" href="../../../modules/combinatorics/pc_groups.html#sympy.combinatorics.pc_groups.Collector.map_relation">[docs]</a>    <span class="k">def</span> <span class="nf">map_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a conjugate relation.</span>
<span class="sd">        Given a word formed by two free group elements, the</span>
<span class="sd">        corresponding conjugate relation with those free</span>
<span class="sd">        group elements is formed and mapped with the collected</span>
<span class="sd">        word in the polycyclic presentation.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.named_groups import SymmetricGroup</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.free_groups import free_group</span>
<span class="sd">        &gt;&gt;&gt; G = SymmetricGroup(3)</span>
<span class="sd">        &gt;&gt;&gt; PcGroup = G.polycyclic_group()</span>
<span class="sd">        &gt;&gt;&gt; collector = PcGroup.collector</span>
<span class="sd">        &gt;&gt;&gt; F, x0, x1 = free_group(&quot;x0, x1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; w = x1*x0</span>
<span class="sd">        &gt;&gt;&gt; collector.map_relation(w)</span>
<span class="sd">        x1**2</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">array_form</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">key</span> <span class="o">=</span> <span class="p">((</span><span class="n">s2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_group</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pc_presentation</span><span class="p">[</span><span class="n">key</span><span class="p">]</span></div>


<div class="viewcode-block" id="Collector.collected_word"><a class="viewcode-back" href="../../../modules/combinatorics/pc_groups.html#sympy.combinatorics.pc_groups.Collector.collected_word">[docs]</a>    <span class="k">def</span> <span class="nf">collected_word</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">word</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the collected form of a word.</span>

<span class="sd">        A word `w` is called collected, if `w = x{i_1}**a_1*...*x{i_r}**a_r`</span>
<span class="sd">        with `i_1 &lt; i_2&lt; ... &lt; i_r` and `a_j` is in `{1, ..., s_j-1}`</span>
<span class="sd">        if `s_j != infinity`.</span>
<span class="sd">        Otherwise w is uncollected.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.named_groups import SymmetricGroup</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.perm_groups import PermutationGroup</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.free_groups import free_group</span>
<span class="sd">        &gt;&gt;&gt; G = SymmetricGroup(4)</span>
<span class="sd">        &gt;&gt;&gt; PcGroup = G.polycyclic_group()</span>
<span class="sd">        &gt;&gt;&gt; collector = PcGroup.collector</span>
<span class="sd">        &gt;&gt;&gt; F, x0, x1, x2, x3 = free_group(&quot;x0, x1, x2, x3&quot;)</span>
<span class="sd">        &gt;&gt;&gt; word = x3*x2*x1*x0</span>
<span class="sd">        &gt;&gt;&gt; collected_word = collector.collected_word(word)</span>
<span class="sd">        &gt;&gt;&gt; free_to_perm = {}</span>
<span class="sd">        &gt;&gt;&gt; free_group = collector.free_group</span>
<span class="sd">        &gt;&gt;&gt; for sym, gen in zip(free_group.symbols, collector.pcgs):</span>
<span class="sd">        ...     free_to_perm[sym] = gen</span>
<span class="sd">        &gt;&gt;&gt; G1 = PermutationGroup()</span>
<span class="sd">        &gt;&gt;&gt; for w in word:</span>
<span class="sd">        ...     sym = w[0]</span>
<span class="sd">        ...     perm = free_to_perm[sym]</span>
<span class="sd">        ...     G1 = PermutationGroup([perm] + G1.generators)</span>
<span class="sd">        &gt;&gt;&gt; G2 = PermutationGroup()</span>
<span class="sd">        &gt;&gt;&gt; for w in collected_word:</span>
<span class="sd">        ...     sym = w[0]</span>
<span class="sd">        ...     perm = free_to_perm[sym]</span>
<span class="sd">        ...     G2 = PermutationGroup([perm] + G2.generators)</span>
<span class="sd">        &gt;&gt;&gt; G1 == G2</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">free_group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_group</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimal_uncollected_subword</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">w</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subword_index</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">free_group</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">low</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">s1</span><span class="p">,</span> <span class="n">e1</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">re</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relative_order</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">s1</span><span class="p">]]</span>
                <span class="n">q</span> <span class="o">=</span> <span class="n">e1</span> <span class="o">//</span> <span class="n">re</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">e1</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">re</span>

                <span class="n">key</span> <span class="o">=</span> <span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">re</span><span class="p">),</span> <span class="p">)</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">free_group</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pc_presentation</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                    <span class="n">word_</span> <span class="o">=</span> <span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pc_presentation</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">q</span><span class="p">))</span>
                    <span class="n">word_</span> <span class="o">=</span> <span class="n">free_group</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">word_</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">r</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">word_</span> <span class="o">=</span> <span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">),</span> <span class="p">)</span>
                        <span class="n">word_</span> <span class="o">=</span> <span class="n">free_group</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">word_</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">word_</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">eliminate_word</span><span class="p">(</span><span class="n">free_group</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">word_</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s2</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="p">((</span><span class="n">s2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">)</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="n">free_group</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
                <span class="n">word_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_relation</span><span class="p">(</span><span class="n">free_group</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
                <span class="n">word_</span> <span class="o">=</span> <span class="n">s2</span><span class="o">*</span><span class="n">word_</span><span class="o">**</span><span class="n">e1</span>
                <span class="n">word_</span> <span class="o">=</span> <span class="n">free_group</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">word_</span><span class="p">)</span>
                <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">substituted_word</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">word_</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s2</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="p">((</span><span class="n">s2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">)</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="n">free_group</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
                <span class="n">word_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_relation</span><span class="p">(</span><span class="n">free_group</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
                <span class="n">word_</span> <span class="o">=</span> <span class="n">s2</span><span class="o">**-</span><span class="mi">1</span><span class="o">*</span><span class="n">word_</span><span class="o">**</span><span class="n">e1</span>
                <span class="n">word_</span> <span class="o">=</span> <span class="n">free_group</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">word_</span><span class="p">)</span>
                <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">substituted_word</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">word_</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">word</span></div>


<div class="viewcode-block" id="Collector.pc_relators"><a class="viewcode-back" href="../../../modules/combinatorics/pc_groups.html#sympy.combinatorics.pc_groups.Collector.pc_relators">[docs]</a>    <span class="k">def</span> <span class="nf">pc_relators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the polycyclic presentation.</span>

<span class="sd">        There are two types of relations used in polycyclic</span>
<span class="sd">        presentation.</span>
<span class="sd">        i) Power relations of the form `x{i}^re{i} = R{i}{i}`,</span>
<span class="sd">        `for 0 &lt;= i &lt; length(pcgs)` where `x` represents polycyclic</span>
<span class="sd">        generator and `re` is the corresponding relative order.</span>

<span class="sd">        ii) Conjugate relations of the form `x{j}^-1*x{i}*x{j}`,</span>
<span class="sd">        `for 0 &lt;= j &lt; i &lt;= length(pcgs)`.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.named_groups import SymmetricGroup</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; S = SymmetricGroup(49).sylow_subgroup(7)</span>
<span class="sd">        &gt;&gt;&gt; der = S.derived_series()</span>
<span class="sd">        &gt;&gt;&gt; G = der[len(der)-2]</span>
<span class="sd">        &gt;&gt;&gt; PcGroup = G.polycyclic_group()</span>
<span class="sd">        &gt;&gt;&gt; collector = PcGroup.collector</span>
<span class="sd">        &gt;&gt;&gt; pcgs = PcGroup.pcgs</span>
<span class="sd">        &gt;&gt;&gt; len(pcgs)</span>
<span class="sd">        6</span>
<span class="sd">        &gt;&gt;&gt; free_group = collector.free_group</span>
<span class="sd">        &gt;&gt;&gt; pc_resentation = collector.pc_presentation</span>
<span class="sd">        &gt;&gt;&gt; free_to_perm = {}</span>
<span class="sd">        &gt;&gt;&gt; for s, g in zip(free_group.symbols, pcgs):</span>
<span class="sd">        ...     free_to_perm[s] = g</span>

<span class="sd">        &gt;&gt;&gt; for k, v in pc_resentation.items():</span>
<span class="sd">        ...     k_array = k.array_form</span>
<span class="sd">        ...     if v != ():</span>
<span class="sd">        ...        v_array = v.array_form</span>
<span class="sd">        ...     lhs = Permutation()</span>
<span class="sd">        ...     for gen in k_array:</span>
<span class="sd">        ...         s = gen[0]</span>
<span class="sd">        ...         e = gen[1]</span>
<span class="sd">        ...         lhs = lhs*free_to_perm[s]**e</span>
<span class="sd">        ...     if v == ():</span>
<span class="sd">        ...         assert lhs.is_identity</span>
<span class="sd">        ...         continue</span>
<span class="sd">        ...     rhs = Permutation()</span>
<span class="sd">        ...     for gen in v_array:</span>
<span class="sd">        ...         s = gen[0]</span>
<span class="sd">        ...         e = gen[1]</span>
<span class="sd">        ...         rhs = rhs*free_to_perm[s]**e</span>
<span class="sd">        ...     assert lhs == rhs</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">free_group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_group</span>
        <span class="n">rel_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relative_order</span>
        <span class="n">pc_relators</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">perm_to_free</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">pcgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pcgs</span>

        <span class="k">for</span> <span class="n">gen</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pcgs</span><span class="p">,</span> <span class="n">free_group</span><span class="o">.</span><span class="n">generators</span><span class="p">):</span>
            <span class="n">perm_to_free</span><span class="p">[</span><span class="n">gen</span><span class="o">**-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="o">**-</span><span class="mi">1</span>
            <span class="n">perm_to_free</span><span class="p">[</span><span class="n">gen</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>

        <span class="n">pcgs</span> <span class="o">=</span> <span class="n">pcgs</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pc_series</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">rel_order</span> <span class="o">=</span> <span class="n">rel_order</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">collected_gens</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">gen</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pcgs</span><span class="p">):</span>
            <span class="n">re</span> <span class="o">=</span> <span class="n">rel_order</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">relation</span> <span class="o">=</span> <span class="n">perm_to_free</span><span class="p">[</span><span class="n">gen</span><span class="p">]</span><span class="o">**</span><span class="n">re</span>
            <span class="n">G</span> <span class="o">=</span> <span class="n">series</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="n">l</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">generator_product</span><span class="p">(</span><span class="n">gen</span><span class="o">**</span><span class="n">re</span><span class="p">,</span> <span class="n">original</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">l</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

            <span class="n">word</span> <span class="o">=</span> <span class="n">free_group</span><span class="o">.</span><span class="n">identity</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
                <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="o">*</span><span class="n">perm_to_free</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>

            <span class="n">word</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collected_word</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
            <span class="n">pc_relators</span><span class="p">[</span><span class="n">relation</span><span class="p">]</span> <span class="o">=</span> <span class="n">word</span> <span class="k">if</span> <span class="n">word</span> <span class="k">else</span> <span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pc_presentation</span> <span class="o">=</span> <span class="n">pc_relators</span>

            <span class="n">collected_gens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">collected_gens</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">conj</span> <span class="o">=</span> <span class="n">collected_gens</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">collected_gens</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">conjugator</span> <span class="o">=</span> <span class="n">perm_to_free</span><span class="p">[</span><span class="n">conj</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">collected_gens</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">conjugated</span> <span class="o">=</span> <span class="n">perm_to_free</span><span class="p">[</span><span class="n">collected_gens</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>

                    <span class="n">relation</span> <span class="o">=</span> <span class="n">conjugator</span><span class="o">**-</span><span class="mi">1</span><span class="o">*</span><span class="n">conjugated</span><span class="o">*</span><span class="n">conjugator</span>
                    <span class="n">gens</span> <span class="o">=</span> <span class="n">conj</span><span class="o">**-</span><span class="mi">1</span><span class="o">*</span><span class="n">collected_gens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">conj</span>

                    <span class="n">l</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">generator_product</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">original</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
                    <span class="n">l</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                    <span class="n">word</span> <span class="o">=</span> <span class="n">free_group</span><span class="o">.</span><span class="n">identity</span>
                    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
                        <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="o">*</span><span class="n">perm_to_free</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>

                    <span class="n">word</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collected_word</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
                    <span class="n">pc_relators</span><span class="p">[</span><span class="n">relation</span><span class="p">]</span> <span class="o">=</span> <span class="n">word</span> <span class="k">if</span> <span class="n">word</span> <span class="k">else</span> <span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pc_presentation</span> <span class="o">=</span> <span class="n">pc_relators</span>

        <span class="k">return</span> <span class="n">pc_relators</span></div>

<div class="viewcode-block" id="Collector.exponent_vector"><a class="viewcode-back" href="../../../modules/combinatorics/pc_groups.html#sympy.combinatorics.pc_groups.Collector.exponent_vector">[docs]</a>    <span class="k">def</span> <span class="nf">exponent_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the exponent vector of length equal to the</span>
<span class="sd">        length of polycyclic generating sequence.</span>

<span class="sd">        For a given generator/element `g` of the polycyclic group,</span>
<span class="sd">        it can be represented as `g = x{1}**e{1}....x{n}**e{n}`,</span>
<span class="sd">        where `x{i}` represents polycyclic generators and `n` is</span>
<span class="sd">        the number of generators in the free_group equal to the length</span>
<span class="sd">        of pcgs.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.named_groups import SymmetricGroup</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.permutations import Permutation</span>
<span class="sd">        &gt;&gt;&gt; G = SymmetricGroup(4)</span>
<span class="sd">        &gt;&gt;&gt; PcGroup = G.polycyclic_group()</span>
<span class="sd">        &gt;&gt;&gt; collector = PcGroup.collector</span>
<span class="sd">        &gt;&gt;&gt; pcgs = PcGroup.pcgs</span>
<span class="sd">        &gt;&gt;&gt; collector.exponent_vector(G[0])</span>
<span class="sd">        [1, 0, 0, 0]</span>
<span class="sd">        &gt;&gt;&gt; exp = collector.exponent_vector(G[1])</span>
<span class="sd">        &gt;&gt;&gt; g = Permutation()</span>
<span class="sd">        &gt;&gt;&gt; for i in range(len(exp)):</span>
<span class="sd">        ...     g = g*pcgs[i]**exp[i] if exp[i] else g</span>
<span class="sd">        &gt;&gt;&gt; assert g == G[1]</span>

<span class="sd">        References</span>
<span class="sd">        ==========</span>

<span class="sd">        .. [1] Holt, D., Eick, B., O&#39;Brien, E.</span>
<span class="sd">               &quot;Handbook of Computational Group Theory&quot;</span>
<span class="sd">               Section 8.1.1, Definition 8.4</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">free_group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_group</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">PermutationGroup</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pcgs</span><span class="p">:</span>
            <span class="n">G</span> <span class="o">=</span> <span class="n">PermutationGroup</span><span class="p">([</span><span class="n">g</span><span class="p">]</span> <span class="o">+</span> <span class="n">G</span><span class="o">.</span><span class="n">generators</span><span class="p">)</span>
        <span class="n">gens</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">generator_product</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">original</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">gens</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

        <span class="n">perm_to_free</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">sym</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">free_group</span><span class="o">.</span><span class="n">generators</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pcgs</span><span class="p">):</span>
            <span class="n">perm_to_free</span><span class="p">[</span><span class="n">g</span><span class="o">**-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sym</span><span class="o">**-</span><span class="mi">1</span>
            <span class="n">perm_to_free</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">sym</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">free_group</span><span class="o">.</span><span class="n">identity</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gens</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">*</span><span class="n">perm_to_free</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>

        <span class="n">pc_presentation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pc_presentation</span>
        <span class="n">word</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collected_word</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>
        <span class="n">exp_vector</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">free_group</span><span class="p">)</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">array_form</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">word</span><span class="p">:</span>
            <span class="n">exp_vector</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">exp_vector</span></div>

<div class="viewcode-block" id="Collector.depth"><a class="viewcode-back" href="../../../modules/combinatorics/pc_groups.html#sympy.combinatorics.pc_groups.Collector.depth">[docs]</a>    <span class="k">def</span> <span class="nf">depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the depth of a given element.</span>

<span class="sd">        The depth of a given element `g` is defined by</span>
<span class="sd">        `dep{g} = i if e{1} = e{2} = ... = e{i-1} = 0`</span>
<span class="sd">        and `e{i} != 0`, where `e` represents the exponent-vector.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.named_groups import SymmetricGroup</span>
<span class="sd">        &gt;&gt;&gt; G = SymmetricGroup(3)</span>
<span class="sd">        &gt;&gt;&gt; PcGroup = G.polycyclic_group()</span>
<span class="sd">        &gt;&gt;&gt; collector = PcGroup.collector</span>
<span class="sd">        &gt;&gt;&gt; collector.depth(G[0])</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; collector.depth(G[1])</span>
<span class="sd">        1</span>

<span class="sd">        References</span>
<span class="sd">        ==========</span>

<span class="sd">        .. [1] Holt, D., Eick, B., O&#39;Brien, E.</span>
<span class="sd">               &quot;Handbook of Computational Group Theory&quot;</span>
<span class="sd">               Section 8.1.1, Definition 8.5</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exp_vector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exponent_vector</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">exp_vector</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pcgs</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Collector.leading_exponent"><a class="viewcode-back" href="../../../modules/combinatorics/pc_groups.html#sympy.combinatorics.pc_groups.Collector.leading_exponent">[docs]</a>    <span class="k">def</span> <span class="nf">leading_exponent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the leading non-zero exponent.</span>

<span class="sd">        The leading exponent for a given element `g` is defined</span>
<span class="sd">        by `leading_exponent{g} = e{i}`, if `depth{g} = i`.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; from sympy.combinatorics.named_groups import SymmetricGroup</span>
<span class="sd">        &gt;&gt;&gt; G = SymmetricGroup(3)</span>
<span class="sd">        &gt;&gt;&gt; PcGroup = G.polycyclic_group()</span>
<span class="sd">        &gt;&gt;&gt; collector = PcGroup.collector</span>
<span class="sd">        &gt;&gt;&gt; collector.leading_exponent(G[1])</span>
<span class="sd">        1</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">exp_vector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exponent_vector</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="n">depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">depth</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pcgs</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">exp_vector</span><span class="p">[</span><span class="n">depth</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/sympylogo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">SymPy 1.5.dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019 SymPy Development Team.
      Last updated on Jul 26, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>